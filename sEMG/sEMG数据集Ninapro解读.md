[toc]



## 1ã€æ•°æ®é›†ä»‹ç»

åš`sEMG`ä¿¡å·çš„å¸¸ç”¨æ•°æ®é›†æ˜¯`NinaPro`ï¼ˆhttp://ninapro.hevs.ch/ï¼‰ï¼Œç›®å‰åŒ…å«`DB[1-10]`ä¸ªå®Œæ•´æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«æˆªè‚¢è€…å’Œéæˆªè‚¢è€…çš„`sEMG`ä¿¡å·æ–‡ä»¶ã€‚æ‰€æœ‰æ•°æ®é›†çš„æè¿°éƒ½ç±»ä¼¼ï¼Œç†Ÿæ‚‰å•ä¸ªæ•°æ®é›†çš„æ•°æ®ç»„æˆå³å¯ï¼Œè¯¥æ–‡ä¸»è¦ä»¥`NinaproDB1`æ•°æ®é›†æ¥ä»‹ç»ã€‚


## 2ã€NinaproDB1

è¯¥ `DB1`æ•°æ®é›†åŒ…æ‹¬ `27 `åå®Œæ•´å—è¯•è€…é‡å¤ `52 `æ¬¡**æ‰‹éƒ¨åŠ¨ä½œ**ä»¥åŠ**ä¼‘æ¯ä½ç½®æ—¶**çš„**è¡¨é¢è‚Œç”µå›¾**å’Œ**è¿åŠ¨å­¦æ•°æ®**ã€‚

<img src="https://img-blog.csdnimg.cn/img_convert/b397a2631d26a6b88156662bb0bfa218.png" alt="20231031144830" style="zoom: 67%;" />

## 3ã€é‡‡é›†è®¾å¤‡

`sEMG `æ•°æ®ä½¿ç”¨ `10 `ä¸ª `Otto Bock MyoBock 13E200 `ç”µæè·å–ï¼Œè€Œè¿åŠ¨å­¦æ•°æ®ä½¿ç”¨ `Cyberglove 2` æ•°æ®æ‰‹å¥—è·å–ã€‚

<img src="https://img-blog.csdnimg.cn/img_convert/6512ef2438e4b21182931ae35cd6795b.png" style="zoom: 25%;" />

## 4ã€é‡‡é›†åŠ¨ä½œ

è¯¥æ•°æ®é›†åŒ…æ‹¬ `52 `ä¸ªä¸åŒåŠ¨ä½œçš„` 10 `æ¬¡é‡å¤ã€‚å—è¯•è€…è¢«è¦æ±‚é‡å¤åœ¨ç¬”è®°æœ¬ç”µè„‘å±å¹•ä¸Šä»¥ç”µå½±å½¢å¼æ˜¾ç¤ºçš„åŠ¨ä½œã€‚

å®éªŒåˆ†ä¸ºä¸‰ä¸ªç»ƒä¹ ï¼š 

- æ‰‹æŒ‡çš„åŸºæœ¬åŠ¨ä½œã€‚ 

- ç­‰è·ã€ç­‰å¼ çš„æ‰‹éƒ¨é…ç½®å’ŒåŸºæœ¬çš„æ‰‹è…•è¿åŠ¨ã€‚ 

- æŠ“æ¡å’ŒåŠŸèƒ½æ€§åŠ¨ä½œã€‚

<img src="https://img-blog.csdnimg.cn/img_convert/8e50cb045ea56a73747b3008f6b5f2e6.png" style="zoom: 40%;" />

## 5ã€æ–‡ä»¶æ•°æ®æè¿°

ä¸‹è½½å…¶ä¸­`s1`å—è¯•è€…çš„æ•°æ®æ–‡ä»¶ï¼Œè§£å‹åï¼š

![20231031145026](https://img-blog.csdnimg.cn/img_convert/04111c44c6e81da61854dc1ef49fa917.png)

å¯ä»¥ä½¿ç”¨`matlab`æˆ–è€…`python`æ¥è¯»å–æ–‡ä»¶å†…å®¹ã€‚ä½¿ç”¨matlabç›´æ¥åŒå‡»`mat`æ–‡ä»¶å°±å¯ä»¥åœ¨å˜é‡åŒºè·å¾—æ•°æ®äº†ï¼Œè¿™é‡Œä»…æ¼”ç¤ºç”¨`python`æ¥è¯»å–æ–‡ä»¶æ•°æ®ã€‚

```python
# å®‰è£…æ‰€éœ€è¦çš„åº“ï¼špip install scipy

import scipy.io as scipy

path = 'ä½ çš„matæ–‡ä»¶è·¯å¾„'
file = scipy.loatmat(path)

# fileæ˜¯ä¸ªå­—å…¸ç±»å‹ï¼ŒæŸ¥çœ‹æ‰€æœ‰çš„é”®å€¼
print(file.keys())

# è¾“å‡ºï¼š
dict_keys(['__header__', '__version__', '__globals__', 'emg', 'stimulus', 'glove', 'subject', 'exercise', 'repetition', 'restimulus', 'rerepetition'])
```

æ¥ä¸‹æ¥è§£é‡Šæ¯ä¸ªé”®çš„å«ä¹‰ï¼š

1. `__header__`ï¼šæ–‡ä»¶å¤´ä¿¡æ¯ï¼ŒåŒ…å«æ–‡ä»¶åˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ã€‚
2. `__version__`ï¼šæ–‡ä»¶ç‰ˆæœ¬ä¿¡æ¯ã€‚
3. `__globals__`ï¼šä¸ºç©ºï¼Œå¯¹åç»­å®éªŒæ²¡å½±å“ã€‚
4. `emg`ï¼šæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ¨ªåæ ‡æ˜¯æ—¶é—´æˆ³ï¼Œçºµåæ ‡ä»£è¡¨é€šé“ï¼Œ`S1_A1_E1.mat`çš„`emg`æ•°æ®å½¢çŠ¶ä¸º`(101014, 10)`ï¼Œç¬¬ `1-8` åˆ—æ˜¯åœ¨æ¡¡è‚±å…³èŠ‚é«˜åº¦å¤„å›´ç»•å‰è‡‚ç­‰è·åˆ†å¸ƒçš„ç”µæã€‚ç¬¬` 9` åˆ—å’Œç¬¬` 10 `åˆ—åŒ…å«æ¥è‡ªæŒ‡æµ…å±ˆè‚Œå’Œä¼¸è‚Œçš„ä¸»è¦æ´»åŠ¨ç‚¹çš„ä¿¡å·ã€‚
5. `stimulus`ï¼šæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ¨ªåæ ‡æ˜¯æ—¶é—´æˆ³ï¼Œçºµåæ ‡ä»…æœ‰ä¸€åˆ—ï¼Œå€¼ä»£è¡¨å—è¯•è€…æ ¹æ®æ‰€æ˜¾ç¤ºçš„ç”µå½±é‡å¤çš„åŠ¨ä½œã€‚
6. `glove`ï¼šæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ¨ªåæ ‡æ˜¯æ—¶é—´æˆ³ï¼Œçºµåæ ‡ä»£è¡¨ï¼ˆ`22`ä¸ªï¼‰é€šé“ã€‚ç½‘ç»œæ‰‹å¥— 22 ä¸ªä¼ æ„Ÿå™¨çš„æœªæ ¡å‡†ä¿¡å·ã€‚
7. `subject`ï¼šå—è¯•è€…ç¼–å·ã€‚
8. `exercise`ï¼šè®­ç»ƒç¼–å·ï¼Œå‰é¢è¯´äº†`DB1`å…±æœ‰ä¸‰ä¸ªè®­ç»ƒï¼Œè¿™ä¸ªå°±æ˜¯ä¸‰ä¸ªè®­ç»ƒçš„ç¼–å·ã€‚
9. `repetition`ï¼šæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ¨ªåæ ‡æ˜¯æ—¶é—´æˆ³ï¼Œçºµåæ ‡ä»…æœ‰ä¸€åˆ—ã€‚ä»£è¡¨æ¯ä¸ªæ—¶é—´æˆ³æ‰€å¯¹åº”æ‰‹åŠ¿é‡å¤æ‰§è¡Œçš„æ¬¡æ•°ï¼Œæœ€å¤§ä¸º`10`ï¼Œæœ€å°ä¸º`0`ï¼Œ`0`è¡¨ç¤ºä¼‘æ¯é˜¶æ®µã€‚
10. `restimulus`ï¼šæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ¨ªåæ ‡æ˜¯æ—¶é—´æˆ³ï¼Œçºµåæ ‡ä»…æœ‰ä¸€åˆ—ã€‚æ¯ä¸ªå€¼è¡¨ç¤ºè®­ç»ƒ`Aã€Bã€C`çš„æ‰‹åŠ¿ç¼–å·ã€‚å…·æœ‰äº‹åç»†åŒ–çš„è¿åŠ¨æ ‡ç­¾çš„æŒç»­æ—¶é—´ï¼Œä»¥ä¾¿æ›´å¥½åœ°å¯¹åº”äºçœŸå®çš„è¿åŠ¨ã€‚==å¯ä»¥ä½œä¸ºæ‰‹åŠ¿åˆ†ç±»æ ‡ç­¾æ¥ç”¨==ã€‚
11. `rerepetition`ï¼šä¸`repetition`æœ‰ç›¸ä¼¼çš„å«ä¹‰ï¼Œæ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ¨ªåæ ‡æ˜¯æ—¶é—´æˆ³ï¼Œçºµåæ ‡ä»…æœ‰ä¸€åˆ—ã€‚ä»£è¡¨æ¯ä¸ªæ—¶é—´æˆ³æ‰€å¯¹åº”æ‰‹åŠ¿é‡å¤æ‰§è¡Œçš„æ¬¡æ•°ï¼Œæœ€å¤§ä¸º`10`ï¼Œæœ€å°ä¸º`0`ï¼Œ`0`è¡¨ç¤ºä¼‘æ¯é˜¶æ®µã€‚

## 6ã€æ•°æ®å¤„ç†

### 6.1 è·å–æ•°æ®

```python
data = file['emg']      # (times, channel)
label = file['restimulus']  # (times, 1)
```

### 6.2 æ•°æ®å¤„ç†

`data`ä¸­åŒ…å«å¾ˆå¤šä¼‘æ¯æ®µçš„`semg`æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®`label`æ¥è·å–ä¼‘æ¯æ®µçš„ä¸‹æ ‡å€¼ï¼Œä¹‹åæ ¹æ®ä¸‹æ ‡å€¼æ¥è·å–`data`ä¸­æ‰€æœ‰æ´»åŠ¨æ®µçš„æ•°æ®ã€‚

```python
active_index = (label != 0).flatten()
data = data[active_index]
label = label[active_index]
```

### 6.3 ç‰¹å¾æå–
```python
import numpy as np
'''
    feature: 
        å¹³å‡ç»å¯¹å€¼MAV, åŠ æƒå¹³å‡ç»å¯¹å€¼WMAV, æ–œç‡ç¬¦å·å˜åŒ–
        è¿‡é›¶ç‚¹ç‡ZC, å¨åˆ©æ£®å¹…å€¼WA, æ³¢å½¢é•¿åº¦WL, å‡æ–¹æ ¹RMS
        æ ‡å‡†å·®STD, ç®€å•æ–¹å½¢ç§¯åˆ†SSI, æ–¹å·®VAR, å¹³å‡å¹…åº¦æ”¹å˜AAC
        å‡å€¼MEAN
'''

def MAV(data):
    '''
        data.shape: (n, ch)
        return shape: (ch, )
    '''
    return np.mean(np.abs(data), axis=0)

def WMAV(data):
    n = data.shape[0]
    w = np.logical_and(0.25*n <= data, data <= 0.75*n)
    w = np.where(w, 1.0, 0.5)
    return np.mean(w * np.abs(data), axis=0)

def SSC(data, threshold=10e-7):
    delta = np.flip(np.diff(np.flip(data, axis=0), axis=0)[:-1], axis=0) * \
            np.diff(data, axis=0)[:-1]
    return np.sum(np.where(delta >= threshold, 1.0, 0.), axis=0)

def ZC(data, threshold=10e-7):
    abs_diff = np.abs(np.diff(data, axis=0))
    sign = np.diff(np.sign(data), axis=0)
    log = np.logical_and(sign != 0, abs_diff > threshold)
    return np.sum(log, axis=0)

def WA(data, threshold=10e-7):
    return np.abs(np.fft.fft2(data))**2

def WL(data):
    return np.sum(np.abs(np.diff(data, axis=0)), axis=0)

def RMS(data):
    return np.sqrt(np.mean(data**2, axis=0))

def STD(data):
    return np.std(data, axis=0)

def SSI(data):
    return np.sum(data**2, axis=0)

def VAR(data):
    return np.var(data, axis=0)

def AAC(data):
    return np.mean(np.diff(data, axis=0), axis=0)

def MEAN(data):
    return np.mean(data, axis=0)
```

### 6.4 ä¿¡å·çš„é™å™ª
`sEMG`æœ‰æ•ˆä¿¡å·å¤„äº`20-300Hz`ä¹‹é—´ï¼Œå¯ä»¥ç”¨å·´ç‰¹æ²ƒæ–¯æ»¤æ³¢å™¨è¿›è¡Œå¤„ç†ï¼Œå¹¶é‡‡ç”¨`50`Hzçš„é™·æ³¢æ»¤æ³¢å™¨æ¶ˆé™¤å·¥é¢‘å¹²æ‰°ã€‚
```python
from scipy.signal import butter, filtfilt, iirnotch

# 4é˜¶çš„å·´ç‰¹æ²ƒæ–¯æ»¤æ³¢å™¨ï¼Œ20-300Hzæ»¤æ³¢
def butter_bandpass_filter(data, lowcut=20, highcut=300, fs=1024, order=4):
    nyquist = 0.5 * fs
    low = lowcut / nyquist
    high = highcut / nyquist
    b, a = butter(order, [low, high], btype='band')
    y = filtfilt(b, a, data)
    return y

# å®šä¹‰50 Hz é™·æ³¢æ»¤æ³¢å™¨å‡½æ•°
def notch_filter(data, cutoff=50.0, Q=30.0, fs=1024):
    nyquist = 0.5 * fs
    freq = cutoff / nyquist
    b, a = iirnotch(freq, Q)
    y = filtfilt(b, a, data)
    return y
```

## 7ã€è¸©å‘

### 7.1 æ ‡ç­¾æ— æ³•å¯¹åº”çš„é—®é¢˜

æœ‰æ•°æ®é›†çš„æ–‡ä»¶å­˜åœ¨æ‰‹åŠ¿æ ‡ç­¾ä¸å¯¹çš„æƒ…å†µï¼Œè¿™é‡Œå»ºè®®æ¯æ¬¡è¯»å–`label`åï¼Œæ‰“å°ä¸€ä¸‹åŒ…å«å“ªç±»æ ‡ç­¾å€¼ã€‚è®­ç»ƒ`Aã€Bã€C`å’Œ`D`æ–‡ä»¶çš„æ ‡ç­¾ä¸€å®šè¦å¯¹åº”ä¸Šæ‰‹åŠ¿æ•°é‡ï¼Œéœ€è¦è¿›è¡Œåé¢çš„å¤„ç†ã€‚

```python
unique_labels = np.unique(label)
print(unique_labels)

# ç”±äºæˆ‘è¯»å–çš„æ˜¯è®­ç»ƒ1çš„æ–‡ä»¶ï¼Œå› æ­¤åŒ…å«12ä¸ªæ‰‹åŠ¿æ ‡ç­¾ï¼Œè¿™é‡Œæ˜¯æ²¡é—®é¢˜çš„
# è¾“å‡ºï¼š
array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12], dtype=uint8)
```

### 7.2 restimulusé”®ç¼ºå¤±

ä½¿ç”¨`stimulus`ä»£æ›¿å³å¯ã€‚


# ä¹‹åæ€ä¹ˆå¤„ç†å¯ä»¥æ ¹æ®è‡ªå·±çš„å®éªŒæ¥è¿›è¡Œï¼Œå¦‚æœéœ€è¦å¸®åŠ©å¯åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œè®°å¾—ç‚¹ä¸ªæ”¶è—+å…³æ³¨å“¦ğŸ˜€ï¼
